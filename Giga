local function createAuthGUI()
    local player = game.Players.LocalPlayer
    local playerGui = player:WaitForChild("PlayerGui")
    local TweenService = game:GetService("TweenService")

    -- Основной экран GUI
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "NamelessAuthGui"
    screenGui.ResetOnSpawn = false
    screenGui.Parent = playerGui

    -- Центральная панель (уменьшена)
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = UDim2.new(0, 350, 0, 250)
    mainFrame.Position = UDim2.new(0.5, -175, 0.5, -125)
    mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 45)
    mainFrame.BorderSizePixel = 0
    mainFrame.Parent = screenGui -- теперь панель сразу в ScreenGui

    local mainCorner = Instance.new("UICorner")
    mainCorner.CornerRadius = UDim.new(0, 15)
    mainCorner.Parent = mainFrame

    local mainGradient = Instance.new("UIGradient")
    mainGradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, Color3.fromRGB(35, 35, 55)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(25, 25, 40))
    })
    mainGradient.Rotation = 90
    mainGradient.Parent = mainFrame

    local shadowStroke = Instance.new("UIStroke")
    shadowStroke.Thickness = 2
    shadowStroke.Color = Color3.fromRGB(0, 150, 255)
    shadowStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    shadowStroke.Transparency = 0.3
    shadowStroke.Parent = mainFrame

    -- Заголовок
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1, -40, 0, 50)
    titleLabel.Position = UDim2.new(0, 20, 0, 10)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = "NAMELESS HUB"
    titleLabel.TextColor3 = Color3.fromRGB(0, 180, 255)
    titleLabel.TextSize = 24
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextXAlignment = Enum.TextXAlignment.Center
    titleLabel.Parent = mainFrame

    -- Подзаголовок
    local subtitleLabel = Instance.new("TextLabel")
    subtitleLabel.Size = UDim2.new(1, -40, 0, 25)
    subtitleLabel.Position = UDim2.new(0, 20, 0, 60)
    subtitleLabel.BackgroundTransparency = 1
    subtitleLabel.Text = "Get permanent key in the discord!"
    subtitleLabel.TextColor3 = Color3.fromRGB(180, 180, 200)
    subtitleLabel.TextSize = 14
    subtitleLabel.Font = Enum.Font.Gotham
    subtitleLabel.TextXAlignment = Enum.TextXAlignment.Center
    subtitleLabel.Parent = mainFrame

    -- Поле ввода
    local codeFrame = Instance.new("Frame")
    codeFrame.Size = UDim2.new(1, -60, 0, 35)
    codeFrame.Position = UDim2.new(0, 30, 0, 90)
    codeFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 35)
    codeFrame.BorderSizePixel = 0
    codeFrame.Parent = mainFrame

    local codeCorner = Instance.new("UICorner")
    codeCorner.CornerRadius = UDim.new(0, 8)
    codeCorner.Parent = codeFrame

    local codeStroke = Instance.new("UIStroke")
    codeStroke.Thickness = 1
    codeStroke.Color = Color3.fromRGB(60, 60, 80)
    codeStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    codeStroke.Parent = codeFrame

    local codeTextBox = Instance.new("TextBox")
    codeTextBox.Size = UDim2.new(1, -20, 1, 0)
    codeTextBox.Position = UDim2.new(0, 10, 0, 0)
    codeTextBox.BackgroundTransparency = 1
    codeTextBox.Text = ""
    codeTextBox.PlaceholderText = "Enter your code here..."
    codeTextBox.TextColor3 = Color3.fromRGB(255, 255, 255)
    codeTextBox.PlaceholderColor3 = Color3.fromRGB(120, 120, 140)
    codeTextBox.TextSize = 14
    codeTextBox.Font = Enum.Font.Gotham
    codeTextBox.Parent = codeFrame

    -- Кнопки (сдвинуты левее)
    local discordButton = Instance.new("TextButton")
    discordButton.Size = UDim2.new(0.45, 0, 0, 35)
    discordButton.Position = UDim2.new(0, 15, 0, 140) -- было 30, сдвинул на 10px левее
    discordButton.BackgroundColor3 = Color3.fromRGB(88, 101, 242)
    discordButton.BorderSizePixel = 0
    discordButton.Text = "Get Discord"
    discordButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    discordButton.TextSize = 14
    discordButton.Font = Enum.Font.GothamBold
    discordButton.Parent = mainFrame

    local discordCorner = Instance.new("UICorner")
    discordCorner.CornerRadius = UDim.new(0, 8)
    discordCorner.Parent = discordButton

    local verifyButton = Instance.new("TextButton")
    verifyButton.Size = UDim2.new(0.45, 0, 0, 35)
    verifyButton.Position = UDim2.new(0.51, 0, 0, 140) -- было 0.55, чуть ближе
    verifyButton.BackgroundColor3 = Color3.fromRGB(0, 150, 80)
    verifyButton.BorderSizePixel = 0
    verifyButton.Text = "Verify"
    verifyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    verifyButton.TextSize = 14
    verifyButton.Font = Enum.Font.GothamBold
    verifyButton.Parent = mainFrame

    local verifyCorner = Instance.new("UICorner")
    verifyCorner.CornerRadius = UDim.new(0, 8)
    verifyCorner.Parent = verifyButton

    -- Статус
    local statusLabel = Instance.new("TextLabel")
    statusLabel.Size = UDim2.new(1, -40, 0, 25)
    statusLabel.Position = UDim2.new(0, 20, 0, 185)
    statusLabel.BackgroundTransparency = 1
    statusLabel.Text = ""
    statusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
    statusLabel.TextSize = 12
    statusLabel.Font = Enum.Font.Gotham
    statusLabel.TextXAlignment = Enum.TextXAlignment.Center
    statusLabel.Parent = mainFrame

    -- Анимация
    mainFrame.Size = UDim2.new(0, 0, 0, 0)
    local openTween = TweenService:Create(mainFrame, 
        TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.Out),
        {Size = UDim2.new(0, 350, 0, 250)}
    )
    openTween:Play()

    -- Ховер эффект
    local function addHoverEffect(button, hoverColor, originalColor)
        button.MouseEnter:Connect(function()
            TweenService:Create(button,
                TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
                {BackgroundColor3 = hoverColor}
            ):Play()
        end)

        button.MouseLeave:Connect(function()
            TweenService:Create(button,
                TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
                {BackgroundColor3 = originalColor}
            ):Play()
        end)
    end

    addHoverEffect(discordButton, Color3.fromRGB(115, 128, 255), Color3.fromRGB(88, 101, 242))
    addHoverEffect(verifyButton, Color3.fromRGB(0, 180, 100), Color3.fromRGB(0, 150, 80))

    -- Загрузка сохраненного кода
    local savedCode = readFile(codeFileName)
    if savedCode then
        codeTextBox.Text = savedCode
    end

    -- Обработчики кнопок
    discordButton.MouseButton1Click:Connect(function()
        if copyToClipboard(DISCORD_LINK) then
            discordButton.Text = "Link Copied!"
            statusLabel.Text = "Discord link copied to clipboard!"
            statusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
            task.delay(3, function()
                discordButton.Text = "Get Discord"
                statusLabel.Text = ""
            end)
        else
            statusLabel.Text = "Link: " .. DISCORD_LINK
            statusLabel.TextColor3 = Color3.fromRGB(100, 200, 255)
            task.delay(3, function()
                statusLabel.Text = ""
            end)
        end
    end)

    verifyButton.MouseButton1Click:Connect(function()
        local enteredCode = codeTextBox.Text:gsub("%s+", "") -- Убираем пробелы
        
        if enteredCode == "" then
            statusLabel.Text = "Please enter a code!"
            statusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
            return
        end

        -- Простая проверка кода (можно усложнить)
        if string.len(enteredCode) >= 6 then
            statusLabel.Text = "Code verified successfully!"
            statusLabel.TextColor3 = Color3.fromRGB(100, 255, 100)
            
            -- Сохранение кода
            writeFile(codeFileName, enteredCode)
            
            -- Анимация закрытия
            local closeTween = TweenService:Create(mainFrame,
                TweenInfo.new(0.3, Enum.EasingStyle.Back, Enum.EasingDirection.In),
                {Size = UDim2.new(0, 0, 0, 0)}
            )
            closeTween:Play()
            
            closeTween.Completed:Connect(function()
                screenGui:Destroy()
                -- Запуск основного скрипта
                initializeMainScript()
            end)
        else
            statusLabel.Text = "Invalid code! Please check your code."
            statusLabel.TextColor3 = Color3.fromRGB(255, 100, 100)
        end
    end)

    -- Эффект фокуса на поле ввода
    codeTextBox.Focused:Connect(function()
        local focusTween = TweenService:Create(codeStroke,
            TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
            {Color = Color3.fromRGB(0, 150, 255)}
        )
        focusTween:Play()
    end)

    codeTextBox.FocusLost:Connect(function()
        local unfocusTween = TweenService:Create(codeStroke,
            TweenInfo.new(0.2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
            {Color = Color3.fromRGB(60, 60, 80)}
        )
        unfocusTween:Play()
    end)
end
